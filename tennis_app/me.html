<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>个人中心 - 网球训练助手</title>
  <!-- Tailwind CSS CDN -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- 自定义样式 -->
  <style>
    /* 确保模态框可以滚动 */
    .modal-container {
      max-height: 90vh;
      overflow-y: auto;
    }
    
    /* 确保关闭按钮始终可见 */
    .close-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      z-index: 60;
      background-color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    
    /* 修复滚动问题 */
    .overflow-y-auto {
      overflow-y: auto !important;
      -webkit-overflow-scrolling: touch;
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="max-w-md mx-auto bg-white min-h-screen">
    <!-- 顶部用户信息 -->
    <div class="bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-6 rounded-b-3xl">
      <div class="flex items-center mb-4">
        <div class="w-16 h-16 rounded-full bg-white p-1 mr-4">
          <img src="https://via.placeholder.com/60" alt="用户头像" class="w-full h-full rounded-full object-cover">
        </div>
        <div>
          <h1 class="text-xl font-bold">张三</h1>
          <p class="text-blue-100">网球爱好者</p>
        </div>
        <button class="ml-auto bg-white bg-opacity-20 p-2 rounded-full">
          <i class="fas fa-cog text-white"></i>
        </button>
      </div>
      <!-- 成就统计 -->
      <div class="flex justify-between text-center">
        <div>
          <div class="text-2xl font-bold">12</div>
          <div class="text-xs text-blue-100">训练次数</div>
        </div>
        <div>
          <div class="text-2xl font-bold">4</div>
          <div class="text-xs text-blue-100">比赛次数</div>
        </div>
        <div>
          <div class="text-2xl font-bold">2</div>
          <div class="text-xs text-blue-100">获得奖项</div>
        </div>
        <div>
          <div class="text-2xl font-bold">87</div>
          <div class="text-xs text-blue-100">技术评分</div>
        </div>
      </div>
    </div>

    <!-- 会员信息 -->
    <div class="p-4 bg-yellow-50 mx-4 rounded-xl -mt-4 flex justify-between items-center shadow-sm">
      <div>
        <div class="text-xs text-gray-500">会员等级</div>
        <div class="font-bold text-yellow-600">黄金会员</div>
      </div>
      <div class="h-6 w-px bg-yellow-200"></div>
      <div>
        <div class="text-xs text-gray-500">到期时间</div>
        <div class="font-bold text-yellow-600">2024-12-31</div>
      </div>
      <button class="bg-yellow-500 text-white text-xs px-3 py-1 rounded-full">续费</button>
    </div>

    <!-- 训练数据 -->
    <div class="p-4">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-bold text-gray-800">训练数据</h2>
        <div class="flex gap-2">
          <button id="openTrend" class="text-xs bg-blue-500 text-white px-3 py-1 rounded-full">历史趋势分析</button>
          <button id="openAnalysis" class="text-xs bg-green-500 text-white px-3 py-1 rounded-full">本次训练分析</button>
        </div>
      </div>
      <div class="grid grid-cols-2 gap-3 mb-4">
        <div class="bg-white p-3 rounded-xl shadow-sm">
          <div class="text-xs text-gray-500 mb-1">累计训练时长</div>
          <div class="font-bold text-xl">24小时</div>
          <div class="text-xs text-green-500">+2小时</div>
        </div>
        <div class="bg-white p-3 rounded-xl shadow-sm">
          <div class="text-xs text-gray-500 mb-1">累计击球数</div>
          <div class="font-bold text-xl">1,248</div>
          <div class="text-xs text-green-500">+168</div>
        </div>
        <div class="bg-white p-3 rounded-xl shadow-sm">
          <div class="text-xs text-gray-500 mb-1">平均入界率</div>
          <div class="font-bold text-xl">87%</div>
          <div class="text-xs text-green-500">+2%</div>
        </div>
        <div class="bg-white p-3 rounded-xl shadow-sm">
          <div class="text-xs text-gray-500 mb-1">最高球速</div>
          <div class="font-bold text-xl">128km/h</div>
          <div class="text-xs text-green-500">+5km/h</div>
        </div>
      </div>
    </div>

    <!-- 功能菜单 -->
    <div class="p-4">
      <h2 class="text-lg font-bold text-gray-800 mb-4">功能菜单</h2>
      <div class="grid grid-cols-2 gap-3">
        <div class="bg-white p-4 rounded-xl shadow-sm flex items-center">
          <div class="w-10 h-10 rounded-full bg-red-100 flex items-center justify-center mr-3">
            <i class="fas fa-heart text-red-500"></i>
          </div>
          <div>
            <div class="font-medium">我的收藏</div>
            <div class="text-xs text-gray-500">5个教学视频</div>
          </div>
        </div>
        <div class="bg-white p-4 rounded-xl shadow-sm flex items-center">
          <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center mr-3">
            <i class="fas fa-calendar-check text-blue-500"></i>
          </div>
          <div>
            <div class="font-medium">训练记录</div>
            <div class="text-xs text-gray-500">12次训练</div>
          </div>
        </div>
        <div class="bg-white p-4 rounded-xl shadow-sm flex items-center">
          <div class="w-10 h-10 rounded-full bg-yellow-100 flex items-center justify-center mr-3">
            <i class="fas fa-trophy text-yellow-500"></i>
          </div>
          <div>
            <div class="font-medium">我的成就</div>
            <div class="text-xs text-gray-500">解锁3个徽章</div>
          </div>
        </div>
        <div class="bg-white p-4 rounded-xl shadow-sm flex items-center">
          <div class="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center mr-3">
            <i class="fas fa-medal text-purple-500"></i>
          </div>
          <div>
            <div class="font-medium">比赛记录</div>
            <div class="text-xs text-gray-500">4场比赛</div>
          </div>
        </div>
      </div>
    </div>

    <!-- 设置菜单 -->
    <div class="p-4">
      <h2 class="text-lg font-bold text-gray-800 mb-4">设置</h2>
      <div class="bg-white rounded-xl shadow-sm overflow-hidden">
        <div class="p-4 border-b border-gray-100 flex justify-between items-center">
          <div class="flex items-center">
            <i class="fas fa-bell text-blue-500 mr-3"></i>
            <span>消息通知</span>
          </div>
          <i class="fas fa-chevron-right text-gray-400"></i>
        </div>
        <div class="p-4 border-b border-gray-100 flex justify-between items-center">
          <div class="flex items-center">
            <i class="fas fa-lock text-blue-500 mr-3"></i>
            <span>隐私设置</span>
          </div>
          <i class="fas fa-chevron-right text-gray-400"></i>
        </div>
        <div class="p-4 border-b border-gray-100 flex justify-between items-center">
          <div class="flex items-center">
            <i class="fas fa-question-circle text-blue-500 mr-3"></i>
            <span>帮助与反馈</span>
          </div>
          <i class="fas fa-chevron-right text-gray-400"></i>
        </div>
        <div class="p-4 flex justify-between items-center">
          <div class="flex items-center">
            <i class="fas fa-info-circle text-blue-500 mr-3"></i>
            <span>关于我们</span>
          </div>
          <i class="fas fa-chevron-right text-gray-400"></i>
        </div>
      </div>
    </div>

    <!-- 历史趋势分析模态框 -->
    <div id="trendModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
      <div class="bg-white rounded-2xl shadow-xl w-full max-w-lg modal-container p-6 relative">
        <!-- 关闭按钮 -->
        <button id="closeTrend" class="close-btn text-gray-600 hover:text-gray-900">
          <i class="fas fa-times"></i>
        </button>
        <div class="font-bold text-xl mb-4">历史趋势分析</div>
        <!-- 时间维度选择 -->
        <div class="flex flex-wrap gap-2 mb-4">
          <button class="trend-btn bg-blue-100 text-blue-600 px-3 py-1 rounded">最近7天</button>
          <button class="trend-btn bg-gray-100 text-gray-600 px-3 py-1 rounded">30天</button>
          <button class="trend-btn bg-gray-100 text-gray-600 px-3 py-1 rounded">3个月</button>
          <button class="trend-btn bg-gray-100 text-gray-600 px-3 py-1 rounded">6个月</button>
          <button class="trend-btn bg-gray-100 text-gray-600 px-3 py-1 rounded">1年</button>
          <input type="date" class="trend-date px-2 py-1 border rounded text-xs" style="width:110px;">
          <span class="text-gray-400">-</span>
          <input type="date" class="trend-date px-2 py-1 border rounded text-xs" style="width:110px;">
        </div>
        <!-- 技术进步曲线 -->
        <div class="mb-6">
          <div class="font-semibold text-sm mb-2">技术进步曲线</div>
          <canvas id="trendSkillChart" height="120"></canvas>
        </div>
        <!-- 阶段性对比 -->
        <div class="mb-2">
          <div class="font-semibold text-sm mb-2">阶段性对比</div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <div class="bg-green-50 rounded-lg p-3 flex flex-col items-center">
              <div class="text-xs text-gray-400 mb-1">月度技术报告</div>
              <div class="font-bold text-lg text-green-600">87分</div>
              <div class="text-xs text-green-500">+5分</div>
            </div>
            <div class="bg-blue-50 rounded-lg p-3 flex flex-col items-center">
              <div class="text-xs text-gray-400 mb-1">季度进步幅度</div>
              <div class="font-bold text-lg text-blue-600">+12%</div>
              <div class="text-xs text-blue-500">击球入界率</div>
            </div>
            <div class="bg-yellow-50 rounded-lg p-3 flex flex-col items-center">
              <div class="text-xs text-gray-400 mb-1">里程碑成就</div>
              <div class="font-bold text-lg text-yellow-600">1000球</div>
              <div class="text-xs text-yellow-500">累计击球</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 本次训练分析模态框 -->
    <div id="analysisModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
      <div class="bg-white rounded-2xl shadow-xl w-full max-w-3xl modal-container p-6 relative">
        <!-- 关闭按钮 -->
        <button id="closeAnalysis" class="close-btn text-gray-600 hover:text-gray-900">
          <i class="fas fa-times"></i>
        </button>
        
        <!-- 顶部概览区域 -->
        <div class="mb-6">
          <div class="flex flex-wrap items-center justify-between mb-4">
            <div class="flex flex-col gap-1">
              <span class="text-xs text-gray-400">训练时间</span>
              <span class="font-bold text-lg text-gray-800">2024-06-01 15:30</span>
            </div>
            <div class="flex flex-col gap-1">
              <span class="text-xs text-gray-400">总击球数</span>
              <span class="font-bold text-lg text-gray-800">168</span>
            </div>
            <div class="flex flex-col gap-1">
              <span class="text-xs text-gray-400">训练时长</span>
              <span class="font-bold text-lg text-gray-800">45分钟</span>
            </div>
            <div class="flex flex-col gap-1 items-center">
              <span class="text-xs text-gray-400">整体技术评分</span>
              <span class="font-bold text-2xl text-green-500">8.7</span>
            </div>
          </div>
          <!-- 正手/反手切换选项卡 -->
          <div class="flex gap-4 mb-2">
            <button id="tabForehand" class="tab-btn px-4 py-2 rounded-lg font-medium text-green-600 bg-green-100">正手</button>
            <button id="tabBackhand" class="tab-btn px-4 py-2 rounded-lg font-medium text-gray-600 bg-gray-100">反手</button>
          </div>
        </div>
        <!-- 正手分析区域 -->
        <div id="forehandPanel">
          <div class="grid grid-cols-2 gap-4 mb-6">
            <!-- 入界率卡片 -->
            <div class="bg-green-50 rounded-xl p-4 flex flex-col items-center">
              <div class="font-bold text-2xl text-green-600 mb-1">91%</div>
              <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                <div class="bg-green-500 h-2 rounded-full" style="width:91%"></div>
              </div>
              <div class="text-xs text-gray-500">入界率 <span class="ml-2 text-green-500">+2%</span></div>
            </div>
            <!-- 出界率卡片 -->
            <div class="bg-blue-50 rounded-xl p-4 flex flex-col items-center">
              <div class="font-bold text-2xl text-blue-600 mb-1">6%</div>
              <canvas id="fhOutPie" width="60" height="60"></canvas>
              <div class="text-xs text-gray-500 mt-1">出界率</div>
            </div>
            <!-- 下网率卡片 -->
            <div class="bg-yellow-50 rounded-xl p-4 flex flex-col items-center">
              <div class="font-bold text-2xl text-yellow-600 mb-1">2%</div>
              <div class="text-xs text-yellow-600">建议：挥拍高度略低</div>
            </div>
            <!-- 未接到球率卡片 -->
            <div class="bg-gray-50 rounded-xl p-4 flex flex-col items-center">
              <div class="font-bold text-2xl text-gray-600 mb-1">1%</div>
              <div class="text-xs text-gray-500">平均反应时间 0.42s</div>
            </div>
          </div>
          <!-- 详细分析图表 -->
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <div class="bg-white rounded-xl p-4 shadow border border-gray-100">
              <div class="font-semibold text-sm mb-2">击球结果时间轴</div>
              <canvas id="fhTimeline" height="80"></canvas>
            </div>
            <div class="bg-white rounded-xl p-4 shadow border border-gray-100">
              <div class="font-semibold text-sm mb-2">失误类型分布</div>
              <canvas id="fhMistakePie" height="80"></canvas>
            </div>
            <div class="bg-white rounded-xl p-4 shadow border border-gray-100">
              <div class="font-semibold text-sm mb-2">击球热力图</div>
              <canvas id="fhHeatmap" width="120" height="80"></canvas>
            </div>
          </div>
        </div>
        <!-- 反手分析区域 -->
        <div id="backhandPanel" class="hidden">
          <div class="grid grid-cols-2 gap-4 mb-6">
            <div class="bg-green-50 rounded-xl p-4 flex flex-col items-center">
              <div class="font-bold text-2xl text-green-600 mb-1">84%</div>
              <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                <div class="bg-green-500 h-2 rounded-full" style="width:84%"></div>
              </div>
              <div class="text-xs text-green-500">+1%</div>
            </div>
            <div class="bg-blue-50 rounded-xl p-4 flex flex-col items-center">
              <div class="font-bold text-2xl text-blue-600 mb-1">10%</div>
              <canvas id="bhOutPie" width="60" height="60"></canvas>
              <div class="text-xs text-gray-500 mt-1">出界率</div>
            </div>
            <div class="bg-yellow-50 rounded-xl p-4 flex flex-col items-center">
              <div class="font-bold text-2xl text-yellow-600 mb-1">4%</div>
              <div class="text-xs text-yellow-600">建议：提前引拍</div>
            </div>
            <div class="bg-gray-50 rounded-xl p-4 flex flex-col items-center">
              <div class="font-bold text-2xl text-gray-600 mb-1">2%</div>
              <div class="text-xs text-gray-500">平均反应时间 0.48s</div>
            </div>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <div class="bg-white rounded-xl p-4 shadow border border-gray-100">
              <div class="font-semibold text-sm mb-2">击球结果时间轴</div>
              <canvas id="bhTimeline" height="80"></canvas>
            </div>
            <div class="bg-white rounded-xl p-4 shadow border border-gray-100">
              <div class="font-semibold text-sm mb-2">失误类型分布</div>
              <canvas id="bhMistakePie" height="80"></canvas>
            </div>
            <div class="bg-white rounded-xl p-4 shadow border border-gray-100">
              <div class="font-semibold text-sm mb-2">击球热力图</div>
              <canvas id="bhHeatmap" width="120" height="80"></canvas>
            </div>
          </div>
        </div>
        <!-- 对比分析区域 -->
        <div class="mb-4">
          <div class="bg-white rounded-xl p-4 shadow border border-gray-100">
            <div class="font-semibold text-sm mb-2">正手 vs 反手雷达图对比</div>
            <canvas id="compareRadar" height="120"></canvas>
            <div class="flex flex-wrap gap-2 mt-2 text-xs text-gray-600">
              <span class="px-2 py-1 rounded bg-green-100">入界率</span>
              <span class="px-2 py-1 rounded bg-blue-100">出界率</span>
              <span class="px-2 py-1 rounded bg-yellow-100">下网率</span>
              <span class="px-2 py-1 rounded bg-gray-200">未接到球</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
    // 等待DOM加载完成后执行
    document.addEventListener('DOMContentLoaded', function() {
      // 示例数据
      const trainLabels = ['第1次', '第2次', '第3次', '第4次', '第5次'];
      const trendData = {
          labels: trainLabels,
          datasets: [
              {
                  label: '正手入界率',
                  data: [85, 88, 90, 92, 91],
                  borderColor: '#22c55e',
                  backgroundColor: 'rgba(34,197,94,0.1)',
                  tension: 0.4,
                  fill: false
              },
              {
                  label: '正手出界率',
                  data: [8, 7, 6, 5, 6],
                  borderColor: '#3b82f6',
                  backgroundColor: 'rgba(59,130,246,0.1)',
                  tension: 0.4,
                  fill: false
              },
              {
                  label: '正手下网率',
                  data: [5, 4, 3, 2, 2],
                  borderColor: '#facc15',
                  backgroundColor: 'rgba(250,204,21,0.1)',
                  tension: 0.4,
                  fill: false
              },
              {
                  label: '正手未接到球',
                  data: [2, 1, 1, 1, 1],
                  borderColor: '#6b7280',
                  backgroundColor: 'rgba(107,114,128,0.1)',
                  tension: 0.4,
                  fill: false
              },
              {
                  label: '反手入界率',
                  data: [78, 80, 82, 85, 84],
                  borderColor: '#a21caf',
                  backgroundColor: 'rgba(162,28,175,0.1)',
                  borderDash: [5,5],
                  tension: 0.4,
                  fill: false
              },
              // 其他击球类型可继续添加
          ]
      };
      const trendConfig = {
          type: 'line',
          data: trendData,
          options: {
              responsive: true,
              plugins: {
                  legend: { position: 'top' },
                  tooltip: { mode: 'index', intersect: false }
              },
              interaction: { mode: 'nearest', axis: 'x', intersect: false },
              scales: {
                  y: { min: 0, max: 100, ticks: { callback: v => v + '%' } }
              }
          }
      };
      
      // 初始化历史趋势分析图表
      const trendSkillChart = new Chart(document.getElementById('trendSkillChart'), {
        type: 'line',
        data: {
          labels: ['1月','2月','3月','4月','5月','6月'],
          datasets: [
            {label:'入界率',data:[80,82,85,88,90,92],borderColor:'#22c55e',backgroundColor:'rgba(34,197,94,0.1)',tension:0.4,fill:false},
            {label:'失误率',data:[15,13,11,9,8,7],borderColor:'#f87171',backgroundColor:'rgba(248,113,113,0.1)',tension:0.4,fill:false},
            {label:'综合评分',data:[75,78,82,85,87,90],borderColor:'#3b82f6',backgroundColor:'rgba(59,130,246,0.1)',tension:0.4,fill:false}
          ]
        },
        options: {
          responsive:true,
          plugins:{legend:{position:'top'},tooltip:{mode:'index',intersect:false}},
          interaction:{mode:'nearest',axis:'x',intersect:false},
          scales:{y:{min:0,max:100,ticks:{callback:v=>v+'%'}}}
        }
      });

      // 击球落点分布示例（散点图）
      const courtData = {
          datasets: [
              {
                  label: '正手',
                  data: [ {x: 60, y: 40}, {x: 120, y: 80}, {x: 200, y: 60} ],
                  backgroundColor: '#22c55e',
                  pointRadius: 8
              },
              {
                  label: '反手',
                  data: [ {x: 80, y: 180}, {x: 160, y: 200} ],
                  backgroundColor: '#a21caf',
                  pointRadius: 8
              },
              {
                  label: '切削',
                  data: [ {x: 140, y: 120} ],
                  backgroundColor: '#f59e42',
                  pointRadius: 8
              },
              {
                  label: '截击',
                  data: [ {x: 180, y: 40} ],
                  backgroundColor: '#3b82f6',
                  pointRadius: 8
              }
          ]
      };
      const courtConfig = {
          type: 'scatter',
          data: courtData,
          options: {
              plugins: {
                  legend: { position: 'top' },
                  tooltip: {
                      callbacks: {
                          label: ctx => `${ctx.dataset.label}: (${ctx.parsed.x}, ${ctx.parsed.y})`
                      }
                  }
              },
              scales: {
                  x: { min: 0, max: 350, display: false },
                  y: { min: 0, max: 250, display: false }
              },
              onClick: (e, elements, chart) => {
                  if (elements.length > 0) {
                      const {datasetIndex, index} = elements[0];
                      const point = chart.data.datasets[datasetIndex].data[index];
                      alert(`${chart.data.datasets[datasetIndex].label}落点：(${point.x}, ${point.y})`);
                  }
              }
          }
      };
      
      // 初始化其他图表
      new Chart(document.getElementById('fhOutPie'), {type:'doughnut',data:{labels:['长出','宽出'],datasets:[{data:[4,2],backgroundColor:['#3b82f6','#60a5fa']}]},options:{plugins:{legend:{display:false}}}});
      new Chart(document.getElementById('fhMistakePie'), {type:'pie',data:{labels:['出界','下网','未接到'],datasets:[{data:[6,2,1],backgroundColor:['#3b82f6','#facc15','#6b7280']}]},options:{plugins:{legend:{display:true}}}});
      new Chart(document.getElementById('fhTimeline'), {type:'bar',data:{labels:['1','2','3','4','5','6','7','8','9','10'],datasets:[{label:'入界',data:[1,1,1,1,1,1,1,1,1,1],backgroundColor:'#22c55e'},{label:'出界',data:[0,0,0,1,0,0,0,0,1,0],backgroundColor:'#3b82f6'},{label:'下网',data:[0,0,0,0,0,1,0,0,0,0],backgroundColor:'#facc15'}]},options:{plugins:{legend:{display:true}}}});
      // 热力图用散点图模拟
      new Chart(document.getElementById('fhHeatmap'), {type:'scatter',data:{datasets:[{label:'成功',data:[{x:30,y:40},{x:60,y:60},{x:90,y:30}],backgroundColor:'#22c55e',pointRadius:8},{label:'失误',data:[{x:80,y:70},{x:100,y:20}],backgroundColor:'#f87171',pointRadius:8}]},options:{scales:{x:{min:0,max:120,display:false},y:{min:0,max:80,display:false}},plugins:{legend:{display:false}}}});
      // 反手
      new Chart(document.getElementById('bhOutPie'), {type:'doughnut',data:{labels:['长出','宽出'],datasets:[{data:[7,3],backgroundColor:['#3b82f6','#60a5fa']}]},options:{plugins:{legend:{display:false}}}});
      new Chart(document.getElementById('bhMistakePie'), {type:'pie',data:{labels:['出界','下网','未接到'],datasets:[{data:[10,4,2],backgroundColor:['#3b82f6','#facc15','#6b7280']}]},options:{plugins:{legend:{display:true}}}});
      new Chart(document.getElementById('bhTimeline'), {type:'bar',data:{labels:['1','2','3','4','5','6','7','8','9','10'],datasets:[{label:'入界',data:[1,1,1,1,1,1,1,1,1,1],backgroundColor:'#a21caf'},{label:'出界',data:[0,0,1,0,0,0,0,1,0,0],backgroundColor:'#3b82f6'},{label:'下网',data:[0,0,0,0,1,0,0,0,0,0],backgroundColor:'#facc15'}]},options:{plugins:{legend:{display:true}}}});
      new Chart(document.getElementById('bhHeatmap'), {type:'scatter',data:{datasets:[{label:'成功',data:[{x:20,y:30},{x:50,y:60},{x:70,y:20}],backgroundColor:'#a21caf',pointRadius:8},{label:'失误',data:[{x:60,y:50},{x:90,y:10}],backgroundColor:'#f87171',pointRadius:8}]},options:{scales:{x:{min:0,max:120,display:false},y:{min:0,max:80,display:false}},plugins:{legend:{display:false}}}});
      // 雷达图对比
      new Chart(document.getElementById('compareRadar'), {type:'radar',data:{labels:['入界率','出界率','下网率','未接到球'],datasets:[{label:'正手',data:[91,6,2,1],backgroundColor:'rgba(34,197,94,0.2)',borderColor:'#22c55e'},{label:'反手',data:[84,10,4,2],backgroundColor:'rgba(162,28,175,0.2)',borderColor:'#a21caf'}]},options:{plugins:{legend:{display:true}}}});

      // 本次训练分析模态框交互
      document.getElementById('openAnalysis').addEventListener('click', function() {
        document.getElementById('analysisModal').classList.remove('hidden');
      });
      document.getElementById('closeAnalysis').addEventListener('click', function() {
        document.getElementById('analysisModal').classList.add('hidden');
      });
      
      // 本次训练分析模态框交互 - 确保这些代码正确执行
      const openAnalysisBtn = document.getElementById('openAnalysis');
      const closeAnalysisBtn = document.getElementById('closeAnalysis');
      const analysisModal = document.getElementById('analysisModal');
      
      if(openAnalysisBtn) {
        openAnalysisBtn.addEventListener('click', function() {
          analysisModal.classList.remove('hidden');
        });
      }
      
      if(closeAnalysisBtn) {
        closeAnalysisBtn.addEventListener('click', function() {
          analysisModal.classList.add('hidden');
        });
      }
      
      // 历史趋势分析模态框交互 - 确保这些代码正确执行
      const openTrendBtn = document.getElementById('openTrend');
      const closeTrendBtn = document.getElementById('closeTrend');
      const trendModal = document.getElementById('trendModal');
      
      if(openTrendBtn) {
        openTrendBtn.addEventListener('click', function() {
          trendModal.classList.remove('hidden');
        });
      }
      
      if(closeTrendBtn) {
        closeTrendBtn.addEventListener('click', function() {
          trendModal.classList.add('hidden');
        });
      }
      
      // 添加点击模态框外部区域关闭模态框的功能
      window.addEventListener('click', function(event) {
        if (event.target === analysisModal) {
          analysisModal.classList.add('hidden');
        }
        if (event.target === trendModal) {
          trendModal.classList.add('hidden');
        }
      });
      
      // 阻止模态框内部点击事件冒泡到window
      const modalContents = document.querySelectorAll('.bg-white.rounded-2xl');
      modalContents.forEach(function(content) {
        content.addEventListener('click', function(event) {
          event.stopPropagation();
        });
      });
      
      // 正手/反手切换
      document.getElementById('tabForehand').addEventListener('click', function() {
        document.getElementById('forehandPanel').classList.remove('hidden');
        document.getElementById('backhandPanel').classList.add('hidden');
        this.classList.add('bg-green-100','text-green-600');
        this.classList.remove('bg-gray-100','text-gray-600');
        document.getElementById('tabBackhand').classList.remove('bg-green-100','text-green-600');
        document.getElementById('tabBackhand').classList.add('bg-gray-100','text-gray-600');
      });
      document.getElementById('tabBackhand').addEventListener('click', function() {
        document.getElementById('backhandPanel').classList.remove('hidden');
        document.getElementById('forehandPanel').classList.add('hidden');
        this.classList.add('bg-green-100','text-green-600');
        this.classList.remove('bg-gray-100','text-gray-600');
        document.getElementById('tabForehand').classList.remove('bg-green-100','text-green-600');
        document.getElementById('tabForehand').classList.add('bg-gray-100','text-gray-600');
      });

      // 历史趋势分析模态框交互
      document.getElementById('openTrend').addEventListener('click', function() {
        document.getElementById('trendModal').classList.remove('hidden');
      });
      document.getElementById('closeTrend').addEventListener('click', function() {
        document.getElementById('trendModal').classList.add('hidden');
      });
    });
    </script>
  </div>
</body>
</html>