<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>加载中...</title>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>

<a href="index.html">← 返回首页</a>
<h1 id="page-title">文章加载中...</h1>
<div id="content">加载中...</div>

<script>
  const params = new URLSearchParams(window.location.search);
  const file = params.get("file");

  if (!file) {
    document.title = "未指定文件";
    document.getElementById("content").innerText = "未指定 Markdown 文件";
  } else {
    fetch(file)
      .then(res => {
        if (!res.ok) throw new Error("加载失败：" + res.statusText);
        return res.text();
      })
      .then(text => {
        // 提取第一行 Markdown 一级标题
        const match = text.match(/^#\s+(.*)/m);
        const title = match ? match[1].trim() : "未命名文章";

        // 设置浏览器 tab 的标题
        document.title = title;

        // 也把标题显示在页面中（可选）
        document.getElementById("page-title").innerText = title;

        // 渲染正文内容
        document.getElementById("content").innerHTML = marked.parse(text);
      })
      .catch(err => {
        document.title = "加载失败";
        document.getElementById("content").innerText = "加载失败：" + err.message;
      });
  }
</script>

</body>
</html>

